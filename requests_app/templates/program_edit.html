{% extends 'base.html' %}

{% block content %}
<h1 class="text-3xl font-bold mb-4">Edit Program</h1>

<h2 class="text-2xl font-bold mt-8 mb-4">Edit Program Details</h2>
<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="bg-blue-500 text-white px-4 py-2">Save</button>
    <a href="{% url 'program_detail' program.id %}" class="text-blue-500 hover:underline">Cancel</a>
</form>

<h2 class="text-2xl font-bold mt-8 mb-4">Members</h2>
<ul>
    {% for member, member_form in members_and_forms %}
    <li class="mb-2">
        {{ member.user.username }} ({{ member.member_type.type_name }})
        <form method="post" action="{% url 'edit_member' member.id %}" class="inline">
            {% csrf_token %}
            {{ member_form }}
            <button type="submit" class="bg-blue-500 text-white px-2 py-1">Change</button>
        </form>
        <form method="post" action="{% url 'remove_member' member.id %}" class="inline">
            {% csrf_token %}
            <button type="submit" class="bg-red-500 text-white px-2 py-1">Remove</button>
        </form>
    </li>
    {% endfor %}
</ul>

<h2 class="text-2xl font-bold mt-8 mb-4">Add Member</h2>

<button type="button" class="bg-blue-500 text-white px-4 py-2" onclick="openAddMemberModal();">Add Member</button>
<div id="addMemberModal" class="fixed inset-0 hidden z-50 bg-black bg-opacity-50">
    <div
        class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white p-8 rounded shadow-lg w-3/4 max-w-md">
        <h3 class="text-xl mb-4">Add Member</h3>
        <form method="post" action="{% url 'program_edit' pk=program.pk %}">
            {% csrf_token %}
            {{ member_form.as_p }}
            <button type="submit" class="bg-blue-500 text-white px-4 py-2">Add Member</button>
            <button type="button" class="bg-red-500 text-white px-4 py-2"
                onclick="closeAddMemberModal();">Cancel</button>
        </form>
    </div>
</div>


<script>
    function openAddMemberModal() {
        document.getElementById("addMemberModal").classList.remove("hidden");
    }

    function closeAddMemberModal() {
        document.getElementById("addMemberModal").classList.add("hidden");
    }
</script>
{% endblock %}